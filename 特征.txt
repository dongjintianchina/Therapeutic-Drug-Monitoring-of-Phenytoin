--人口统计学资料
SELECT DISTINCT(SUBJECT.SUBJECT_ID),
	SUBJECT.STAY_ID,
	SUBJECT.HADM_ID,
	ROUND(AGE.AGE,0) AS AGE,
	ICU.GENDER,
	ICU.RACE,
	WEIGHT.WEIGHT,
	HEIGHT.HEIGHT,
	ADMIT.INSURANCE,
	ADMIT.LANGUAGE,
	ADMIT.MARITAL_STATUS,
	CASE 
        WHEN ICUSTAYS.FIRST_CAREUNIT IS NOT NULL THEN 
            regexp_replace(ICUSTAYS.FIRST_CAREUNIT, '.*\((.*)\).*', '\1')
        ELSE 
            NULL 
    END AS MICU_CODE
FROM WORK.keyan_eswofg_mimic_subject AS SUBJECT
LEFT JOIN MIMICIV_DERIVED.AGE AS AGE ON SUBJECT.HADM_ID = AGE.HADM_ID
LEFT JOIN MIMICIV_DERIVED.ICUSTAY_DETAIL AS ICU ON SUBJECT.STAY_ID = ICU.STAY_ID
LEFT JOIN MIMICIV_DERIVED.FIRST_DAY_WEIGHT AS WEIGHT ON SUBJECT.STAY_ID = WEIGHT.STAY_ID
LEFT JOIN MIMICIV_ICU.ICUSTAYS AS ICUSTAYS ON SUBJECT.STAY_ID = ICUSTAYS.STAY_ID
LEFT JOIN MIMICIV_HOSP.ADMISSIONS AS ADMIT ON SUBJECT.HADM_ID = ADMIT.HADM_ID
LEFT JOIN MIMICIV_DERIVED.FIRST_DAY_HEIGHT AS HEIGHT ON SUBJECT.STAY_ID = HEIGHT.STAY_ID
ORDER BY SUBJECT.SUBJECT_ID